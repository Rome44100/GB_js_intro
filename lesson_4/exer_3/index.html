<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzles</title>
</head>
<body>
<script>
"use strict";

// EXERCISE 3

// На базе игры (приняв за пример), созданной в дополнительных видео, 
// реализовать игру «Кто хочет стать миллионером?».
// Т.е. у вас должен быть главный объект, содержащий всю логику игры, 
// который будет иметь методы, например
// метод run, возможно метод init и т.д.
// В игре должны быть заранее подготовлены список вопросов и ответов (как минимум 5 вопросов).
// Игра должна приветствовать пользователя, 
// после чего задавать вопросы пользователю и предлагать варианты
// ответов в виде теста, например:
// Сколько букв в слове "привет":
// a. Пять.
// b. Шесть.
// c. Семь.
// d. Куда я попал?
// Проверять правильный вариант выбрал пользователь или нет, необходимо вести счет.
// По окончании игры, когда было задано 5 вопросов, 
// вы должны сообщить пользователю его счет и предложить
// сыграть снова.
// Также должна быть возможность выхода из игры заранее, 
// если пользователю надоело играть.

let puzzles = [
    {
        question: `Папа мой не по дорожке\nХодит, а по скалам,\nУ него ботинки-кошки,\nБагажа немало -\nЛедоруб, и альпеншток,\nИ страховочный моток.`,
        answers: {
            a: 'Водолаз',
            b: 'Скалолаз',
            c: 'Носильщик',
            d: 'Альпинист'
        },
        right: "d"
    },
    {
        question: `Сидит дед во сто шуб одет, кто его раздевает, тот слезы проливает.`,
        answers: {
            a: 'Чеснок',
            b: 'Лук',
            c: 'Свекла',
            d: 'Кукруза'
        },
        right: "b"
    },
    {
        question: `Маленький, удаленький, сквозь землю прошел, красну шапочку нашел!`,
        answers: {
            a: 'Морковь',
            b: 'Дерево',
            c: 'Гриб',
            d: 'Мухомор'
        },
        right: "c"
    },
    {
        question: `Жив ли кот Шредингера?`,
        answers: {
            a: 'Да',
            b: 'Нет',
            c: 'Ни жив ни мертв',
            d: 'Зависит от наблюдателя'
        },
        right: "d"
    },
    {
        question: `Какой предмет быта альпинистов называется "Гестаповка"`,
        answers: {
            a: 'Тропа',
            b: 'Кружка',
            c: 'Веревка',
            d: 'Палатка'
        },
        right: "b"
    },
]

let game = {
    // счет игры
    score: 0,
    count: 0,
    /**
     * Запуск игры с приглашением
     */
    init() {
        const ask = confirm(`Приветствуем тебя, о страждущий!\nХочешь заработать, ответив на несколько вопросов?`);
        if(ask === true) {
            this.run();
        } else {
            alert("Всего доброго!");
        }
    },
    // Проигрывает все вопросы
    run() {
        let answer = "";
        let again = false;
        let answProp = "";
        let answStr = "";
        
        for(let i = 0; i < puzzles.length; i++) {
            // приготовим строку из вариантов ответов с буквами ответа
            answStr = "";
            for(answProp in puzzles[i].answers) {
                answStr += answProp + ": " + puzzles[i].answers[answProp] + "\n";
            }

            // Спросим у пользователя загадку с вариантами ответов
            // TODO: проверять значение, если не правильно, то while(true) {}
            // можно менять порядок ответов, но тогда придется структуру объекта менять
            answer = prompt(`Вопрос № ${i + 1}!` + `\n` + puzzles[i].question + `\n` +
                            `Варианты ответов:\n` + answStr +
                            `Введите букву ответа (a, b, c, d):\n` +
                            `Для выхода из игры нажмите "Отмена".`);
            
            // Если пользовател нажал отмену, то выходим из игры
            if(answer === null) {
                alert("Вы прервали игру! До свиданья!");
                return;
            }

            // Если есть совпадение по ответу, то переключаем счетчики
            if(answer.toLowerCase() === puzzles[i].right) {
                this.score += 1000;
                this.count++;
            }

            // Если достигли конца списка вопросов, то либо прощаемся, либо заново
            if(i == puzzles.length - 1) {
                if(this.score == 0) {
                    alert("Вы проиграли!");
                } else {
                    alert(`Вы выиграли!!!\nПравильных ответов: ${this.count}!\nВы заработали ${this.score} долларов!\nПоздравляем!!!`);
                }

                // Again?
                again = confirm("Хотите сыграть еще раз?");
                if(true === again) {
                    this.score = 0;
                    this.init();
                } else {
                    alert("До свиданья!");
                    this.score = 0;
                    return;
                }
            }
        }
    }
}

game.init();

</script>
</body>
</html>